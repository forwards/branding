---
title: "CERTIFICATE OF ATTENDANCE"
output:
    pdf_document: 
        latex_engine: xelatex
        keep_tex: false
documentclass: extarticle        
fontsize: 14pt
geometry: top=1in,left=1in, right=1in, bottom=2.8in, includeheadfoot, headsep=0in, headheight=0in
params:
  papersize:
    label: Paper size of output PDF
    value: a4paper
    input: text    
  date: 
    label: Date of workshop
    value: !r lubridate::today() 
    input: date
  location:
    label: Location of workshop
    value: University of Lorraine
    input: text
  workshop:
    label: Workshop title
    value: R Package Development Workshop
    input: text
  curriculum:
    label: path to curriculum
    value: !r system.file("rmarkdown", "templates", "workshop_certificate", "resources", "default_workshop_contents.md", package = "fwdbrand")
    input: text
  certifier:
    label: Certifying person full name
    value: Heather Turner
  credentials:
    label: Certifying person credentials
    value: Workshop Tutor, Forwards Teaching Team Member
    input: text
  attendee:
    label: Attendee
    value: MaÃ«lle Salmon
    input: text
---

---
classoption: "`r params$papersize`"
header-includes: |
  \usepackage{mathspec}
  \usepackage{fontspec}
  \usepackage[default,osfigures,scale=0.95]{opensans}
  \usepackage[T1]{fontenc}
  \usepackage{wallpaper}
  \usepackage{hyperref}
  \usepackage{fancyhdr}
  \usepackage{varwidth}
  \fancypagestyle{plain}{%  the preset of fancyhdr
    \fancyhf{}
    \renewcommand{\headrulewidth}{0pt}
    \renewcommand{\footrulewidth}{0pt}
    \fancyfoot[CO,CE]{
      \vspace{2cm}
      \rule[0in]{3in}{1pt}\\
      \textbf{`r params$certifier`\\
              `r params$credentials`}\\
      \vspace{0.8cm}
      Forwards, the R Foundation taskforce on women and other under-represented groups: \href{https://forwards.github.io/}{\nolinkurl{forwards.github.io/}}}}
---

\CenterWallPaper{1}{logo.png}

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      message = FALSE,
                      warning = FALSE, 
                      fig.align = "center")
```

\begin{center}

\Large \textbf{
```{r, results = 'asis'}
# thanks so much https://stackoverflow.com/questions/46226364/passing-parameters-in-rmarkdown-to-the-text-or-headings
cat(params$attendee)
```
}

\vspace{1.3cm}

\normalsize
has participated in the

\vspace{0.8cm}

\Large \textbf{
```{r, results = 'asis'}
cat(as.character(params$workshop), "\n")
```
}
\normalsize

\large \textbf{
```{r, results = 'asis'}
cat(as.character(params$date), ", ", params$location, "\n")
```
}
\vspace{0.5cm}

\Large \textbf{
Workshop contents:}

\normalsize
\begin{varwidth}{0.8\textwidth}
```{r, results = 'asis', child = params$curriculum}

```

\end{varwidth}

\end{center}
